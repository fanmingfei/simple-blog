---
layout: post
title: "来自智能垃圾桶的诱惑，嵌入式开发初探"
date: 2023-03-27 21:41:00
category: 嵌入式&硬件
---
## 背景原因
![](https://src.fanmingfei.com/images/cb91970ca322769d7073b63379658635.jpg)

最近裸辞离职在老家，正在收拾老家的房子准备住进去，但迫于经济压力，只能先装非常有必要的东西,例如床、马桶、浴室柜等。

![](https://src.fanmingfei.com/images/20230327-221040.gif)

但是垃圾桶是生活必备品，我发现大家现在都在用智能垃圾桶，那种可以感应开盖的，还有那种自动封袋的。我极其的羡慕。但是迫于经济压力，我没有足够的资金购买智能垃圾桶！

![](https://src.fanmingfei.com/images/1cc0d8418a824bc8923ab5f264ebf7e8.jpg)

作为一个学美术的程序员，我在想我要不要去少儿美术培训教小孩，或者去街头卖艺，甚至去给人画遗照赚点钱呢？我想了想算了，给别人留点活路吧，我这么专业的美术人才去了，那些老师、街头艺人、画师不得喝西北风去。我想了想，我除了是学美术的，我还是个程序员啊！

虽然我没有学过嵌入式、硬件、IOT等等技术，但是入门应该不太困难吧！已经好多年没有从0开始学习一门技术了，非常怀念当时学习Web技术的那种感觉，可以没日没夜的去探索新知识，学习东西。之前上班的时候根本没有精力去学习或者搞一些有趣的东西，下班只想躺着看动漫，听爽文。既然现在赋闲在家，那就搞一搞吧！
## 项目启动
俗话说得好，找到一个好师傅就是成功的一半！在这方面我有着得天独厚的优势，我的前公司，北京犬安科技就是一个做车联网安全的公司，这家公司的Slogan是：从硅到云，守护网联汽车安全。可以看出，犬安的硬件软件安全能力都非常的强。像我，天天和测试组的同事去山西面馆吃鱼香肉丝盖饭，喝青岛雪花，他们组里面都是硬件大佬，甚至有人造过火箭。此时不像他们学习，更待何时？

他们告诉我，我需要一个开发版、一个超声波传感器、一个舵机。

我还在研究什么是stm32/esp32的时候，他们告诉我用Arduino，特别简单。我就去研究Arduino，在B站上搜了 Arduino，有一个播放量比较高的系列教程看了一下。我顿时就悟了！

我本来以为我需要买烙铁，焊电路板的，后来我发现，只需要买以上提到的三个东西，外加一个面包版，一些杜邦线就可以，甚至可以不需要面包版。

![](https://src.fanmingfei.com/images/3f06e8bee4babca7a8daba3a23cbe81d.jpg)

当然为了学习，我在淘宝上买了一些乱七八糟的东西，比如按钮、各种电阻、各种颜色led灯、面包版。买各种颜色的LED灯的时候，购买欲泛滥了，就想每个颜色都买一些，什么白发红，白发黄，白发翠绿，后来我买回来发现，不亮的情况下都是白色的，我根本分不清颜色。原来那个白发黄的意思就是不亮的时候是白色，亮了以后发黄色的光～我还买了接受RGB三色的LED灯，不知道为啥不是RGBA，难道不能让灯透明吗？

![](https://src.fanmingfei.com/images/bb83b3aee0190ad57e71bfaee22b9334.jpg)

我还发现不同欧姆的电阻他上面的“杠杠”是不一样的。

![](https://src.fanmingfei.com/images/59dde279dc201815944381f3a73a9b8d.jpg)

主要是这玩意太便宜了，两块钱就买好多，但是作为新手玩家来说，根本用不了。我只买了公对公的杜邦线，然后我又单独下单了其他杜邦线，果然两块多就能包邮。

![](https://src.fanmingfei.com/images/76f41517d2644f1fca69a1f8e4f8fddc.jpg)

我在不同的店铺里面选了很多配件，包括我使用的主要配件：Arduino uno 开发版、SG90舵机、HC-SR04 超声波传感器。

## 开搞
设备买回来以后，废了9牛2虎之力才成功的能把我写的程序上传到开发版里。

一开始一直报下面这个错误，网上众说纷纭，始终没有找到解决方案。
```
avrdude: stk500_getsync() attempt 1 of 10: not in sync: resp=0x30
```
后来我去淘宝详情页仔细研究了一番才搞明白，我本以为我买的是Arduino的开发版，其实是esp8266，只是兼容Arduino。我从淘宝详情页找到了正确姿势，成功的刷入了程序。

看了 Arduino 的视频，我主要悟出来了什么？

开发版、舵机、传感器上有很多小尖尖或者小洞洞，他叫引脚，我们需要把舵机、传感器的引脚，通过一种名为杜邦线的线（通常有公对公/母对母/公对母，代表线两头是小尖尖还是小洞洞），连接到开发板的引脚上。然后使用程序控制某个引脚的电平向舵机发送信号，或者接受传感器的信号。

## 第一个项目
我举一个最简单的LED灯闪烁的例子：
线是这么接的：

![](https://src.fanmingfei.com/images/e8e01dd6518240b5ecb56deae5fe9d96.jpg)

面包版上面，竖着的五个小洞洞里面其实是连在一起的。我的电路是从一个引脚出来，到了一个电阻上，然后连接一个LED灯，然后接地。
接地的概念应该和负极的概念很像，但是不是，不过我暂且不关心它。
为什么不直接从引脚出来接LED，再接地呢，因为视频上说，LED几乎是没有电阻的，如果直接从串口出来接到LED，直接接地的话，开发版就废了，所以加了个电阻。

接下来我让ChatGPT帮我写一个小LED灯闪烁的代码：

![](https://src.fanmingfei.com/images/40c3715329ce5e3d1e23bb695791a790.jpg)

我们可以看到在loop里面，调用了`digitalWrite`，把那个引脚进行了高低电平的切换，这样就实现了小LED灯闪烁的效果，高电平就相当于给小LED灯供电了。

我们只需要把他写的代码中的引脚的编号改成我们的编号就好了。

每款开发版的引脚编号都不一样！我在淘宝上买的这个板，他没有给我资料，我干了一件特别愚蠢的事情，分别给不同的数字编号供电，插线看哪个亮，就记录对应开发版上的引脚号和数字。

第二天我在网上稍微搜了一下资料就找到了。后来我发现，竟然还有一个编号对应两个引脚的，具体为什么我也不知道。

不过具体怎么给舵机传信号，或者接受传感器的信号呢？如果在 Arduino IDE 里面的话就是简单的调用API就好了。这一块我没写代码，都是ChatGPT帮我写的。

![](https://src.fanmingfei.com/images/25284a9b074f601c31432f4481204800.jpg)

## 实现目标的主要部分

我使用同样的方法，制作了垃圾桶的功能的电路和代码。
使用超声波传感器的时候，我发现这玩意都好神奇啊，仿佛是魔法一样。
比如超声波传感器，要先发送一个超声波信号出去，然后等待回波信息，拿到发送和接收的时间差，通过计算得到距离。

![](https://src.fanmingfei.com/images/924cb4c3245aca2e8c4cb72a679e05a5.jpg)


我在调试超声波传感器的时候，我发现我能听到超声波传感器发出的声音，只要耳朵对着它不用靠太近就可以听得到。我朋友说我是超级耳。

有了LED灯的经验以后，超声波识别距离，调用舵机旋转很快就实现了。

![](https://src.fanmingfei.com/images/20230328-001242.gif)

最开始我在考虑这个舵机的力道到底能不能支撑起来垃圾盖子，不过现在感觉力道还是挺大的。不过现在没有办法试，因为我还没有做出来合适的垃圾桶。

## 接下来
接下来我要去找到一个合适的垃圾桶，我也不确定需要用什么方式去打开垃圾桶的盖子，是不是需要其他的比如初中学过的滑轮、齿轮、杠杆原理什么的？这块还没有开始涉猎，等我接下来研究研究来写第二部分。

感谢大家阅读～